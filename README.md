# hrvester <a href="https://sims1253.github.io/hrvester/"><img src="man/figures/logo.png" align="right" height="120" alt="hrvester website" /></a>

[![License](https://img.shields.io/badge/License-MIT-blue.svg)](LICENSE)
[![R-CMD-check](https://github.com/sims1253/hrvester/workflows/R-CMD-check/badge.svg)](https://github.com/sims1253/hrvester/actions)
[![Actions Status](https://github.com/sims1253/hrvester/workflows/Tests/badge.svg)](https://github.com/sims1253/hrvester/actions)
[![Codecov test coverage](https://codecov.io/gh/sims1253/hrvester/graph/badge.svg)](https://app.codecov.io/gh/sims1253/hrvester)

## What is HRV?

Heart Rate Variability (HRV) is the variation in time intervals between heartbeats.
It's a non-invasive measure that reflects the activity of your autonomic nervous
system, and it can be used to assess your body's readiness for training,
recovery status, and overall stress levels.

## What is hrvester?

`hrvester` is an R package designed for analyzing Heart Rate Variability (HRV)
data from `.fit` files generated by Garmin devices (and potentially others).
It focuses on orthostatic tests (measuring HRV while laying down and then
standing up) to provide insights into an athlete's recovery and readiness for
training.

<img src="https://github.com/sims1253/hrvester/blob/master/example/hrv_dashboard.svg?raw=true" width="800" alt="HRV Dashboard Preview">

## Features

- **Orthostatic Test Processing:**  Full pipeline from raw `.fit` files to readiness scores, including:
  - **RR Interval Preprocessing:**  Robust artifact detection, physiological plausibility checks, and moving average filtering to ensure data quality.
  - **HRV Metric Calculation:**  Calculates key HRV metrics like RMSSD and SDNN.
  - **Resting Heart Rate Estimation:**  Uses a robust algorithm to determine resting heart rate.
  - **Heart Rate Recovery Analysis:** Calculates HRR after standing.
- **Neural Recovery Metrics:** Calculates a composite neural recovery score inspired by the BioForce HRV methodology.
- **Sports-Specific Analytics:** Provides specialized metrics and recommendations for Brazilian Jiu-Jitsu and strength training.
- **Automated Reporting:** Generates a daily report summarizing HRV status and providing training recommendations.
- **Optimized Processing:**  Uses `furrr` for parallel processing of multiple `.fit` files.
- **Advanced Caching:**  Version-aware cache invalidation to avoid reprocessing unchanged files.
- **Based on Published Research:** Implements algorithms and metrics from established sources in sports science and physiology.

## Installation

```r
# Install from GitHub
remotes::install_github("sims1253/hrvester")
```

## Quick Start

You will need to bring your own fit file

```r
library(hrvester)

# 1. Process a single .fit file:
result <- process_fit_file("path/to/your/file.fit") # Replace with your file path
print(result)

# 2. Process a directory of .fit files (with caching):
# Create a directory and put your .fit files in it
dir_path <- "path/to/your/fit/files"  # Replace with your directory path
metrics <- process_fit_directory(dir_path)
print(metrics)

# 4. Generate the daily dsashboard
plot_hrv_dashboard(metrics)
```

## Documentation

See the [Reference Manual](man/) for detailed function documentation.

## Contributing

Contributions are welcome! Please see CONTRIBUTING.md for guidelines on how to
contribute (bug reports, feature requests, pull requests).

## Roadmap

- 0.4: Update all the important core components to work as intended
- 0.5: Improve error handling all throughout the package to make it robust
- 0.6: Finalize the user-facing API
- 0.7: Add some vignettes, algorithm and metric documentation
- 1.0: Polish all the things :)
- 1.0+: Enhanced visualization features, interactive dashboard elements and additional sport-specific metrics

## Citation

If using in research, please cite:

```bibtex
@software{hrvester,
  title = {hrvester: Athlete-Centric HRV Analysis Toolkit},
  author = {Maximilian Scholz},
  year = {2025},
  url = {https://github.com/sims1253/hrvester}
}
```


